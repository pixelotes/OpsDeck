{% extends "layout.html" %}

{% block title %}{{ purchase.description }} - {{ super() }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-shopping-cart"></i> {{ purchase.description }}</h2>
    <a href="{{ url_for('purchases.edit_purchase', id=purchase.id) }}" class="btn btn-outline-primary">
        <i class="fas fa-edit"></i> Edit Purchase
    </a>
</div>

<div class="card mb-4">
    <div class="card-header">Purchase Details</div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Internal ID:</strong> {{ purchase.internal_id or 'N/A' }}</p>
                <p><strong>Invoice Number:</strong> {{ purchase.invoice_number or 'N/A' }}</p>
                <p><strong>Purchase Date:</strong> {{ purchase.purchase_date.strftime('%Y-%m-%d') }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Cost:</strong> {{ purchase.currency }}{{ "%.2f"|format(purchase.cost) }}</p>
                <p><strong>Supplier:</strong> {{ purchase.supplier.name if purchase.supplier else 'N/A' }}</p>
                <p><strong>Payment Method:</strong> {{ purchase.payment_method.name if purchase.payment_method else 'N/A' }}</p>
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <i class="fas fa-laptop"></i> Associated Assets ({{ purchase.assets|length }})
    </div>
    <ul class="list-group list-group-flush">
        {% for asset in purchase.assets %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="{{ url_for('assets.asset_detail', id=asset.id) }}">{{ asset.name }}</a>
                <span>{{ asset.model or 'N/A' }}</span>
            </li>
        {% else %}
            <li class="list-group-item text-muted">No assets are currently associated with this purchase.</li>
        {% endfor %}
    </ul>
</div>

<div class="card">
    <div class="card-header">
        <i class="fas fa-keyboard"></i> Associated Peripherals ({{ purchase.peripherals|length }})
    </div>
    <ul class="list-group list-group-flush">
        {% for peripheral in purchase.peripherals %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="{{ url_for('peripherals.edit_peripheral', id=peripheral.id) }}">{{ peripheral.name }}</a>
                <span>{{ peripheral.type or 'N/A' }}</span>
            </li>
        {% else %}
            <li class="list-group-item text-muted">No peripherals are currently associated with this purchase.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}